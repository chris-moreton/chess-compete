# SPSA Tunable Parameters for Rusty Rival
#
# This file contains the current values for parameters being tuned.
# The master controller reads this, generates perturbed versions,
# and updates it after each iteration based on gradient estimates.
#
# Format: parameter_name = { value = X, min = Y, max = Z, step = S, active_from_iteration = N }
# - value: current value (updated by SPSA)
# - min/max: bounds to prevent nonsensical values
# - step: perturbation delta (Î´) for SPSA
# - active_from_iteration: iteration number when this param starts being tuned (default: 1)
#
# Phased tuning approach:
#   Phase 1 (iter 1+):   Core search pruning - 15 params (highest Elo impact)
#   Phase 2 (iter 75+):  Move ordering + extensions - 23 params
#   Phase 3 (iter 150+): Evaluation weights - 10 params
#   Phase 4 (iter 225+): Piece values - 10 params (tapered opening/endgame)

# =============================================================================
# PHASE 1: CORE SEARCH PARAMETERS (active from iteration 1)
# =============================================================================

# Reverse futility pruning (beta pruning)
# If static eval - margin * depth > beta, prune
[beta_prune_margin_per_depth]
value = 345.5209937552591
min = 50
max = 400
step = 20
active_from_iteration = 1

# FROZEN: only 6 discrete values, very volatile (max_chg=6.0), not suitable for SPSA
[beta_prune_max_depth]
value = 10
min = 6
max = 12
step = 0.1
active_from_iteration = 999999

# Null move pruning
# Reduction = base + depth/6 (approximately)
# FROZEN: converged to lower bound, keeping at 2
[null_move_reduce_depth_base]
value = 2
min = 2
max = 6
step = 0.1
active_from_iteration = 99999

# FROZEN: stuck at min bound (1), max_chg=12.12, converged
[null_move_min_depth]
value = 1
min = 1
max = 14
step = 0.1
active_from_iteration = 999999

# SEE (Static Exchange Evaluation) pruning
# At depth N, prune captures with SEE < -margin * N^2
[see_prune_margin]
value = 22.997518944844924
min = 5
max = 70
step = 5
active_from_iteration = 1

# FROZEN: stuck at max bound (14), converged
[see_prune_max_depth]
value = 14
min = 3
max = 14
step = 0.5
active_from_iteration = 999999

# Alpha (futility) pruning margins
# If static eval + margin[depth] < alpha, prune
[alpha_prune_margin_base]
value = 145.43727359580302
min = 50
max = 240
step = 8
active_from_iteration = 1

[alpha_prune_margin_per_depth]
value = 112.45659265875918
min = 32
max = 160
step = 4
active_from_iteration = 1

# Late Move Pruning (LMP) thresholds
# After N moves at depth D, skip remaining quiet moves
[lmp_threshold_depth1]
value = 5.355791823286838
min = 2
max = 16
step = 2
active_from_iteration = 1

[lmp_threshold_depth2]
value = 22.93889490806889
min = 1
max = 32
step = 2
active_from_iteration = 1

[lmp_threshold_depth3]
value = 38.081364710081466
min = 2
max = 48
step = 2
active_from_iteration = 1

# LMR History parameters (core to search efficiency)
# History-based LMR: adjust reduction based on move's historical performance
[lmr_history_good_divisor]
value = 17.287213509456915
min = 2
max = 40
step = 1
active_from_iteration = 1

[lmr_history_bad_divisor]
value = 12.26490696592392
min = 1
max = 32
step = 1
active_from_iteration = 1

# Continuation history thresholds (countermove_history + followup_history combined)
# FROZEN: stuck at max bound (8000), converged
[lmr_continuation_good_threshold]
value = 8000
min = 0
max = 8000
step = 250
active_from_iteration = 999999

# FROZEN: stuck at -4000 with no movement, converged
[lmr_continuation_bad_threshold]
value = -4000
min = -16000
max = -1000
step = 500
active_from_iteration = 999999

# =============================================================================
# PHASE 2: MOVE ORDERING + EXTENSIONS (active from iteration 75)
# =============================================================================

# PROBCUT PARAMETERS
# At high depth, do a shallow search with raised beta
# If a capture fails high, the position is probably winning and can be cut
# FROZEN: stuck at max bound (20), converged
[probcut_min_depth]
value = 20
min = 2
max = 20
step = 1
active_from_iteration = 999999

[probcut_margin]
value = 286.18004097610714
min = 50
max = 300
step = 25
active_from_iteration = 75

# FROZEN: only 4 discrete values [2,6], too small for SPSA
[probcut_depth_reduction]
value = 3
min = 2
max = 6
step = 1
active_from_iteration = 999999

# MULTI-CUT PARAMETERS
# At high depth, if multiple moves fail high at shallow depth,
# assume the position is good and return a beta cutoff
[multicut_min_depth]
value = 19.84235175986101
min = 6
max = 40
step = 1
active_from_iteration = 75

[multicut_depth_reduction]
value = 3.963356592423838
min = 2
max = 10
step = 1
active_from_iteration = 75

[multicut_moves_to_try]
value = 8.014566649106232
min = 3
max = 16
step = 1
active_from_iteration = 75

# FROZEN: only 7 discrete values [3,10], near max bound, converged
[multicut_required_cutoffs]
value = 9
min = 3
max = 10
step = 1
active_from_iteration = 999999

# SINGULAR EXTENSION PARAMETERS
# If the hash move is significantly better than all alternatives, extend its search.
[singular_extension_min_depth]
value = 14.652709382513422
min = 4
max = 20
step = 1
active_from_iteration = 75

# FROZEN: only 7 discrete values [1,8], too small for SPSA
[singular_extension_depth_margin]
value = 6
min = 1
max = 8
step = 1
active_from_iteration = 999999

[singular_extension_depth_reduction]
value = 5.818800383673468
min = 2
max = 10
step = 1
active_from_iteration = 75

# FROZEN: only 5 discrete values [1,6], too small for SPSA
[singular_extension_margin_multiplier]
value = 2
min = 1
max = 6
step = 1
active_from_iteration = 999999

# MOVE ORDERING PARAMETERS
# These control move scoring for alpha-beta search efficiency

# Killer move bonuses
[move_score_mate_killer]
value = 500.1733972620403
min = 500
max = 2000
step = 100
active_from_iteration = 75

[move_score_killer_1]
value = 341.78775525483354
min = 200
max = 1500
step = 75
active_from_iteration = 75

[move_score_killer_2]
value = 210.8876569195526
min = 150
max = 800
step = 50
active_from_iteration = 75

# History score maximum
[move_score_history_max]
value = 459.79050540263273
min = 200
max = 1000
step = 50
active_from_iteration = 75

# Distant killer bonuses (from 2 plies ago)
[move_score_distant_killer_1]
value = 341.04031635578605
min = 50
max = 600
step = 25
active_from_iteration = 75

[move_score_distant_killer_2]
value = 291.5391082288283
min = 50
max = 400
step = 25
active_from_iteration = 75

# Countermove bonus
[move_score_countermove]
value = 150.62521507298862
min = 50
max = 400
step = 25
active_from_iteration = 75

# Pawn push bonuses
[move_score_pawn_push_7th]
value = 99.31753472437137
min = 50
max = 500
step = 15
active_from_iteration = 75

[move_score_pawn_push_6th]
value = 55.16813105118937
min = 0
max = 200
step = 15
active_from_iteration = 75

# History table divisors (scale i16 history to score range)
[countermove_history_divisor]
value = 131.19866712439864
min = 16
max = 512
step = 32
active_from_iteration = 75

[followup_history_divisor]
value = 107.43259275260542
min = 16
max = 1024
step = 16
active_from_iteration = 75

[capture_history_divisor]
value = 967.6344011821051
min = 16
max = 1024
step = 32
active_from_iteration = 75

# =============================================================================
# PHASE 3: EVALUATION PARAMETERS (active from iteration 150)
# =============================================================================
# These control positional evaluation weights - critical for strategic play

# Rook file bonuses (relates to STS "Open Files and Diagonals" category)
[rook_open_file_bonus]
value = 17.797503204005974
min = 5
max = 50
step = 3
active_from_iteration = 150

[rook_semi_open_file_bonus]
value = 20.82498674907698
min = 5
max = 30
step = 3
active_from_iteration = 150

# Knight outposts (relates to STS "Knight Outposts" category)
[value_knight_outpost]
value = 9.913842225607794
min = 0
max = 30
step = 2
active_from_iteration = 150

# Passed pawn bonuses (relates to STS "7th Rank" and pawn advancement)
[value_rook_behind_passed_pawn]
value = 45.74282150153337
min = 5
max = 70
step = 5
active_from_iteration = 150

[value_guarded_passed_pawn]
value = 42.151550603189676
min = 10
max = 60
step = 5
active_from_iteration = 150

# Pawn structure penalties
[doubled_pawn_penalty]
value = 28.324468284025006
min = 5
max = 40
step = 3
active_from_iteration = 150

[isolated_pawn_penalty]
value = 12.533866962337866
min = 0
max = 25
step = 2
active_from_iteration = 150

[value_backward_pawn_penalty]
value = 22.987261965447907
min = 5
max = 40
step = 3
active_from_iteration = 150

# Bishop pair bonus
[value_bishop_pair]
value = 16.370228060484102
min = 0
max = 30
step = 3
active_from_iteration = 150

# Space evaluation (relates to STS "Center Control" category)
[space_bonus_per_square]
value = 19.441489428008335
min = 0
max = 20
step = 1
active_from_iteration = 150

# =============================================================================
# PHASE 4: PIECE VALUES (active from iteration 225)
# =============================================================================
# Tapered evaluation: each piece has opening and endgame values
# Final value = opening_value * phase + endgame_value * (1 - phase)
# where phase goes from 1.0 (opening) to 0.0 (endgame)

# Pawn values (base unit for piece values)
[pawn_value_opening]
value = 100
min = 80
max = 120
step = 5
active_from_iteration = 225

[pawn_value_endgame]
value = 200
min = 150
max = 250
step = 10
active_from_iteration = 225

# Knight values
[knight_value_opening]
value = 620
min = 550
max = 700
step = 15
active_from_iteration = 225

[knight_value_endgame]
value = 680
min = 600
max = 750
step = 15
active_from_iteration = 225

# Bishop values
[bishop_value_opening]
value = 650
min = 580
max = 720
step = 15
active_from_iteration = 225

[bishop_value_endgame]
value = 725
min = 650
max = 800
step = 15
active_from_iteration = 225

# Rook values
[rook_value_opening]
value = 1000
min = 900
max = 1100
step = 20
active_from_iteration = 225

[rook_value_endgame]
value = 1100
min = 1000
max = 1200
step = 20
active_from_iteration = 225

# Queen values
[queen_value_opening]
value = 2000
min = 1800
max = 2200
step = 40
active_from_iteration = 225

[queen_value_endgame]
value = 2300
min = 2100
max = 2500
step = 40
active_from_iteration = 225
