# SPSA Tunable Parameters for Rusty Rival
#
# This file contains the current values for parameters being tuned.
# The master controller reads this, generates perturbed versions,
# and updates it after each iteration based on gradient estimates.
#
# Format: parameter_name = { value = X, min = Y, max = Z, step = S, group = "name" }
# - value: current value (updated by SPSA)
# - min/max: bounds to prevent nonsensical values
# - step: perturbation delta (Î´) for SPSA
# - group: parameter group for selective tuning (each run activates specific groups)
#
# Groups:
#   search-pruning:         Beta pruning, null move, SEE pruning, alpha pruning, LMP (11 params)
#   reductions-extensions:  LMR history, continuation history, probcut, multicut, singular ext (15 params)
#   move-ordering:          Move scoring, killer bonuses, history divisors (12 params)
#   evaluation:             Rook files, outposts, passed pawns, pawn structure, bishop pair, space (10 params)
#   piece-values:           Tapered opening/endgame piece values (10 params)

# =============================================================================
# GROUP: search-pruning
# =============================================================================

# Reverse futility pruning (beta pruning)
# If static eval - margin * depth > beta, prune
[beta_prune_margin_per_depth]
value = 328.2918319743142
min = 50
max = 400
step = 20
group = "search-pruning"

# FREEZE CANDIDATE: only 6 discrete values [6-12], may not converge well
# Consider freezing if it oscillates without settling
[beta_prune_max_depth]
value = 7.986490049623115
min = 6
max = 12
step = 0.2
group = "search-pruning"

# Null move pruning
# Reduction = base + depth/6 (approximately)
# FREEZE CANDIDATE: only 4 discrete values [2-6], previously converged to lower bound
[null_move_reduce_depth_base]
value = 2.473426643242701
min = 2
max = 6
step = 0.15
group = "search-pruning"

# FREEZE CANDIDATE: previously stuck at min bound, discrete depth value
[null_move_min_depth]
value = 13.438279932659142
min = 1
max = 14
step = 0.4
group = "search-pruning"

# SEE (Static Exchange Evaluation) pruning
# At depth N, prune captures with SEE < -margin * N^2
[see_prune_margin]
value = 16.92225523119521
min = 5
max = 70
step = 5
group = "search-pruning"

# FREEZE CANDIDATE: previously stuck at max bound, discrete depth value
[see_prune_max_depth]
value = 13.795570216095769
min = 3
max = 14
step = 0.4
group = "search-pruning"

# Alpha (futility) pruning margins
# If static eval + margin[depth] < alpha, prune
[alpha_prune_margin_base]
value = 56.9147647686537
min = 20
max = 300
step = 8
group = "search-pruning"

[alpha_prune_margin_per_depth]
value = 65.6570447746436
min = 16
max = 160
step = 4
group = "search-pruning"

# Late Move Pruning (LMP) thresholds
# After N moves at depth D, skip remaining quiet moves
[lmp_threshold_depth1]
value = 14.412190247945873
min = 2
max = 16
step = 2
group = "search-pruning"

[lmp_threshold_depth2]
value = 27.130302964853513
min = 1
max = 32
step = 2
group = "search-pruning"

[lmp_threshold_depth3]
value = 17.438207069057626
min = 2
max = 48
step = 2
group = "search-pruning"

# =============================================================================
# GROUP: reductions-extensions
# =============================================================================

# LMR History parameters (core to search efficiency)
# History-based LMR: adjust reduction based on move's historical performance
[lmr_history_good_divisor]
value = 31.779985482765717
min = 2
max = 40
step = 1
group = "reductions-extensions"

[lmr_history_bad_divisor]
value = 29.736294520143588
min = 1
max = 64
step = 1
group = "reductions-extensions"

# Continuation history thresholds (countermove_history + followup_history combined)
# UNFROZEN: was stuck due to formula bug (step in denominator), now fixed
[lmr_continuation_good_threshold]
value = 9400.467574914504
min = 0
max = 16000
step = 250
group = "reductions-extensions"

# UNFROZEN: was stuck due to formula bug, now fixed
[lmr_continuation_bad_threshold]
value = -1437.4541942552219
min = -16000
max = -1000
step = 500
group = "reductions-extensions"

# PROBCUT PARAMETERS
# At high depth, do a shallow search with raised beta
# If a capture fails high, the position is probably winning and can be cut
# FREEZE CANDIDATE: previously stuck at max bound (20), discrete depth value
[probcut_min_depth]
value = 13.861930966228499
min = 2
max = 20
step = 0.5
group = "reductions-extensions"

[probcut_margin]
value = 57.126120059194776
min = 50
max = 300
step = 25
group = "reductions-extensions"

# FREEZE CANDIDATE: only 4 discrete values [2-6], very small range
[probcut_depth_reduction]
value = 5.738355119186638
min = 2
max = 6
step = 0.15
group = "reductions-extensions"

# MULTI-CUT PARAMETERS
# At high depth, if multiple moves fail high at shallow depth,
# assume the position is good and return a beta cutoff
[multicut_min_depth]
value = 30.6181427266799
min = 6
max = 40
step = 1
group = "reductions-extensions"

[multicut_depth_reduction]
value = 3.7860270756430143
min = 2
max = 10
step = 1
group = "reductions-extensions"

[multicut_moves_to_try]
value = 15.655113240173659
min = 3
max = 16
step = 1
group = "reductions-extensions"

# FREEZE CANDIDATE: only 7 discrete values [3-10], small range
[multicut_required_cutoffs]
value = 9.915087262579796
min = 3
max = 10
step = 0.25
group = "reductions-extensions"

# SINGULAR EXTENSION PARAMETERS
# If the hash move is significantly better than all alternatives, extend its search.
[singular_extension_min_depth]
value = 18.81808975393688
min = 4
max = 20
step = 1
group = "reductions-extensions"

# FREEZE CANDIDATE: discrete depth value, small range
[singular_extension_depth_margin]
value = 11.534001425398426
min = 1
max = 12
step = 0.25
group = "reductions-extensions"

[singular_extension_depth_reduction]
value = 3.918574508207186
min = 2
max = 14
step = 1
group = "reductions-extensions"

# FREEZE CANDIDATE: small range
[singular_extension_margin_multiplier]
value = 5.661627918666241
min = 1
max = 10
step = 0.2
group = "reductions-extensions"

# =============================================================================
# GROUP: move-ordering
# =============================================================================

# MOVE ORDERING PARAMETERS
# These control move scoring for alpha-beta search efficiency

# Killer move bonuses
[move_score_mate_killer]
value = 2205.227126047309
min = 500
max = 3000
step = 100
group = "move-ordering"

[move_score_killer_1]
value = 2474.7279366798466
min = 200
max = 2500
step = 75
group = "move-ordering"

[move_score_killer_2]
value = 599.036843754422
min = 150
max = 800
step = 50
group = "move-ordering"

# History score maximum
[move_score_history_max]
value = 882.8312947972455
min = 200
max = 1000
step = 50
group = "move-ordering"

# Distant killer bonuses (from 2 plies ago)
[move_score_distant_killer_1]
value = 591.5759788932821
min = 50
max = 600
step = 25
group = "move-ordering"

[move_score_distant_killer_2]
value = 155.50590966819183
min = 50
max = 400
step = 25
group = "move-ordering"

# Countermove bonus
[move_score_countermove]
value = 156.64153186565025
min = 25
max = 400
step = 25
group = "move-ordering"

# Pawn push bonuses
[move_score_pawn_push_7th]
value = 430.1353055296651
min = 50
max = 750
step = 15
group = "move-ordering"

[move_score_pawn_push_6th]
value = 171.35931330530053
min = 0
max = 200
step = 15
group = "move-ordering"

# History table divisors (scale i16 history to score range)
[countermove_history_divisor]
value = 477.96711571448765
min = 8
max = 512
step = 32
group = "move-ordering"

[followup_history_divisor]
value = 117.07931189982679
min = 8
max = 1024
step = 16
group = "move-ordering"

[capture_history_divisor]
value = 1901.2623864271336
min = 16
max = 2048
step = 32
group = "move-ordering"

# =============================================================================
# GROUP: evaluation
# =============================================================================
# These control positional evaluation weights - critical for strategic play

# Rook file bonuses (relates to STS "Open Files and Diagonals" category)
[rook_open_file_bonus]
value = 37.44540637531875
min = 5
max = 50
step = 3
group = "evaluation"

[rook_semi_open_file_bonus]
value = 22.8683941428463
min = 5
max = 30
step = 3
group = "evaluation"

# Knight outposts (relates to STS "Knight Outposts" category)
[value_knight_outpost]
value = 1.7534191686030747
min = 0
max = 30
step = 2
group = "evaluation"

# Passed pawn bonuses (relates to STS "7th Rank" and pawn advancement)
[value_rook_behind_passed_pawn]
value = 6.684804221343578
min = 5
max = 70
step = 5
group = "evaluation"

[value_guarded_passed_pawn]
value = 56.842798316000824
min = 10
max = 60
step = 5
group = "evaluation"

# Pawn structure penalties
[doubled_pawn_penalty]
value = 5.506748901563768
min = 5
max = 40
step = 3
group = "evaluation"

[isolated_pawn_penalty]
value = 24.293540864130616
min = 0
max = 25
step = 2
group = "evaluation"

[value_backward_pawn_penalty]
value = 33.82038361074125
min = 5
max = 40
step = 3
group = "evaluation"

# Bishop pair bonus
[value_bishop_pair]
value = 30
min = 0
max = 30
step = 3
group = "evaluation"

# Space evaluation (relates to STS "Center Control" category)
[space_bonus_per_square]
value = 17.866177099467706
min = 0
max = 30
step = 1
group = "evaluation"

# =============================================================================
# GROUP: piece-values
# =============================================================================
# Tapered evaluation: each piece has opening and endgame values
# Final value = opening_value * phase + endgame_value * (1 - phase)
# where phase goes from 1.0 (opening) to 0.0 (endgame)

# Pawn values (base unit for piece values)
[pawn_value_opening]
value = 100
min = 80
max = 120
step = 5
group = "piece-values"

[pawn_value_endgame]
value = 200
min = 150
max = 250
step = 10
group = "piece-values"

# Knight values
[knight_value_opening]
value = 620
min = 550
max = 700
step = 15
group = "piece-values"

[knight_value_endgame]
value = 680
min = 600
max = 750
step = 15
group = "piece-values"

# Bishop values
[bishop_value_opening]
value = 650
min = 580
max = 720
step = 15
group = "piece-values"

[bishop_value_endgame]
value = 725
min = 650
max = 800
step = 15
group = "piece-values"

# Rook values
[rook_value_opening]
value = 1000
min = 900
max = 1100
step = 20
group = "piece-values"

[rook_value_endgame]
value = 1100
min = 1000
max = 1200
step = 20
group = "piece-values"

# Queen values
[queen_value_opening]
value = 2000
min = 1800
max = 2200
step = 40
group = "piece-values"

[queen_value_endgame]
value = 2300
min = 2100
max = 2500
step = 40
group = "piece-values"
